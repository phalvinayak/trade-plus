const tfValue={1:"1",2:"3",3:"3",5:"5",10:"10",15:"15",20:"15",25:"30",30:"30",45:"45","1H":"1H",75:"1H",125:"2H","2H":"2H","3H":"3H","4H":"4H",D:"D",W:"W",M:"M"},tfOrder={1:10,2:20,3:30,5:40,10:50,15:60,20:70,25:80,30:90,45:100,"1H":110,75:120,"2H":130,125:140,"3H":150,"4H":160,D:170,W:180,M:190};let stocks=[];const LINK_SELECTOR="a[href*='/stocks-new?']";function getInterval(){let a=[];if(0==$("span.atlas-offset").length)return"D";let s="M";return $("span.atlas-offset").each((t,n)=>{if(0==$(n).closest(".atlas-filter-grabbable").find(".fa-toggle-off").length){let t=$(n).text().trim().toLowerCase(),e=null;t.includes("week")&&(e="W"),t.includes("minute")&&(e=t.split(" ")[0]),(t.includes("month")||t.includes("quarter")||t.includes("year"))&&(e="M"),(t.includes("latest")||t.includes("day"))&&(e="D"),t.includes("hour")&&(e=t.split(" ")[0]+"H"),a.includes(e)||a.push(e),tfOrder[s]>tfOrder[e]&&(s=e)}}),tfValue[s]}function linkify(){let a=getInterval();$(`#root ${LINK_SELECTOR}, .panel-body ${LINK_SELECTOR}, #atlas-grid-layout `+LINK_SELECTOR).each((t,e)=>{let n=$(e);n.parent().find(LINK_SELECTOR).length!=n.parent().find(".chips-hawa-tv_link").length&&(e=getStock(e.href),stocks.includes(e)||stocks.push(e),$(`<a href="https://www.tradingview.com/chart?symbol=${e}&interval=${a}" target="_blank" class="chips-hawa-tv_link">
      <img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMzYiIGhlaWdodD0iMjgiIHZpZXdCb3g9IjAgMCAzNiAyOCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJNMTQgMjJIN1YxMUgwVjRoMTR2MTh6TTI4IDIyaC04bDcuNS0xOGg4TDI4IDIyeiIgZmlsbD0iY3VycmVudENvbG9yIj48L3BhdGg+PGNpcmNsZSBjeD0iMjAiIGN5PSI4IiByPSI0IiBmaWxsPSJjdXJyZW50Q29sb3IiPjwvY2lyY2xlPjwvc3ZnPg=="/>
      </a>`).insertAfter(n))})}function copyScrips(t=!1){stocks=[],t?$("#backtest-table-data "+LINK_SELECTOR).each((t,e)=>{e=getStock(e.href);stocks.includes(e)||stocks.push(e)}):$(".scanner "+LINK_SELECTOR).each((t,e)=>{e=getStock(e.href);stocks.includes(e)||stocks.push(e)})}function getStock(t){const e=new URLSearchParams(new URL(t).search);let n=e.get("symbol");return console.log(t,n),n=n.replace(/\&/g,"_"),console.log(n),"NSE:"+n}let linkifyBtnMarkup='<button class="btn btn-default btn-primary chips-hawa-linkify" type="button"><span>Linkify</span></button>',saveBtnMarkup='<button class="btn btn-default btn-primary chips-hawa-copy" type="button"><span>Copy List</span></button>';function sleep(e){return new Promise(t=>setTimeout(t,e))}function registerBindEvent(){$("#DataTables_Table_0, #backtest-table-data").bind("DOMSubtreeModified",debounce(linkify,250))}$(saveBtnMarkup).insertAfter("#view_backtest"),$(linkifyBtnMarkup).insertAfter("#view_backtest"),$(linkifyBtnMarkup).insertBefore($(".vue-grid-layout")),$(saveBtnMarkup).insertBefore($(".vue-grid-layout")),$("#backtest-container .inked select").after('<button class="btn btn-default btn-primary chips-hawa-linkify chips-hawa-copy chips-hawa-backtest" style="margin-left:0 !important" type="button"><span>Copy List</span></button>'),$("#backtest-container .inked select").after('<button class="btn btn-default btn-primary chips-hawa-linkify chips-hawa-backtest" type="button"><span>Linkify</span></button>'),$(".chips-hawa-linkify").on("click",t=>{t.preventDefault(),linkify(),registerBindEvent()}),$(".chips-hawa-copy").on("click",t=>{t.preventDefault(),$(t.currentTarget).hasClass("chips-hawa-backtest")?copyScrips(!0):copyScrips(),copyToClipboard(stocks.join(","))}),$(".run_scan_button").on("click",async()=>{for(;await sleep(500),1!=$("#DataTables_Table_0").length;);linkify(),registerBindEvent()});const copyToClipboard=t=>{const e=document.createElement("textarea");e.value=t,e.setAttribute("readonly",""),e.style.position="absolute",e.style.left="-9999px",document.body.appendChild(e);t=0<document.getSelection().rangeCount&&document.getSelection().getRangeAt(0);e.select(),document.execCommand("copy"),document.body.removeChild(e),t&&(document.getSelection().removeAllRanges(),document.getSelection().addRange(t))};registerBindEvent(),linkify();